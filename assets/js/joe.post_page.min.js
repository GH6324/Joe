function submit_baidu(e="推送中..."){$("#Joe_Baidu_Record").html(`<span style="color: #E6A23C">${e}</span>`),$.ajax({url:Joe.BASE_API,type:"POST",dataType:"json",data:{routeType:"baidu_push",domain:window.location.protocol+"//"+window.location.hostname,url:encodeURI(window.location.href)},success(e){e.data.error?$("#Joe_Baidu_Record").html('<span style="color: #F56C6C">推送失败，请检查！</span>'):$("#Joe_Baidu_Record").html('<span style="color: #67C23A">推送成功！</span>')},error(e){$("#Joe_Baidu_Record").html('<span style="color: #F56C6C">推送失败，请检查！</span>')}}),Joe.BAIDU_PUSH&&$.ajax({url:Joe.BASE_API,type:"POST",dataType:"json",data:{routeType:"bing_push",domain:window.location.protocol+"//"+window.location.hostname,url:encodeURI(window.location.href)}})}document.addEventListener("DOMContentLoaded",()=>{const e=e=>window.btoa(unescape(encodeURIComponent(e))),o=e=>decodeURIComponent(escape(window.atob(e))),t=$(".joe_detail").attr("data-cid");$.ajax({url:Joe.BASE_API,type:"POST",dataType:"json",data:{routeType:"baidu_record",site:window.location.href},success(e){if(!e.data){if(Joe.BAIDU_PUSH)return void $("#Joe_Baidu_Record").html('<a href="javascript:submit_baidu();" rel="noopener noreferrer nofollow" style="color: #F56C6C">检测失败，提交收录</a>');const e=`https://ziyuan.baidu.com/linksubmit/url?sitename=${encodeURI(window.location.href)}`;return void $("#Joe_Baidu_Record").html(`<a target="_blank" href="${e}" rel="noopener noreferrer nofollow" style="color: #F56C6C">检测失败，提交收录</a>`)}if("已收录"===e.data)return $("#Joe_Baidu_Record").css("color","#67C23A"),void $("#Joe_Baidu_Record").html("已收录");if("未收录"==e.data&&Joe.BAIDU_PUSH)return void submit_baidu("未收录，推送中...");if(Joe.BAIDU_PUSH)return void $("#Joe_Baidu_Record").html(`<a href="javascript:submit_baidu();" rel="noopener noreferrer nofollow" style="color: #F56C6C">${e.data}，提交收录</a>`);const o=`https://ziyuan.baidu.com/linksubmit/url?sitename=${encodeURI(window.location.href)}`;$("#Joe_Baidu_Record").html(`<a target="_blank" href="${o}" rel="noopener noreferrer nofollow" style="color: #F56C6C">${e.data}，提交收录</a>`)}}),Prism.highlightAll(),$("pre[class*='language-']").each(function(e,o){let t=$(o).find("code[class*='language-']").text();t=t.replace(/    /g,"\t");let a=$('<span class="copy"><i class="fa fa-clone"></i></span>');new ClipboardJS(a[0],{text:()=>t}).on("success",()=>{window.code_copy=!0,Qmsg.success(`复制成功 内容版权属于 ${Joe.TITLE} 转载请标明出处！`,{showClose:!0,autoClose:!1})}),$(o).append(a)}),document.addEventListener("copy",function(e){setTimeout(function(){if(!0!==window.code_copy&&!0!==window.post_copy){let e={showClose:!0,autoClose:!1};Qmsg.warning(`本文版权属于 ${Joe.TITLE} 转载请标明出处！`,e),window.post_copy=!0}window.code_copy=!1},100)}),$(".joe_detail__article img:not(img.owo_image)").each(function(){$(this).wrap($(`<span style="display: block;" data-fancybox="Joe" href="${$(this).attr("src")}"></span>`))}),$(".joe_detail__article a:not(.joe_detail__article-anote)").each(function(){$(this).attr({target:"_blank",rel:"noopener noreferrer nofollow"})});{let a=localStorage.getItem(e("views"))?JSON.parse(o(localStorage.getItem(e("views")))):[];const i=a.includes(t);i||$.ajax({url:Joe.BASE_API,type:"POST",dataType:"json",data:{routeType:"handle_views",cid:t},success(o){if(1!==o.code)return;$("#Joe_Article_Views").html(`${o.data.views} 阅读`),a.push(t);const i=e("views"),r=e(JSON.stringify(a));localStorage.setItem(i,r)}})}{let a=localStorage.getItem(e("agree"))?JSON.parse(o(localStorage.getItem(e("agree")))):[];a.includes(t)?$(".joe_detail__agree .icon-1").addClass("active"):$(".joe_detail__agree .icon-2").addClass("active");let i=!1;$(".joe_detail__agree .icon").on("click",function(){if(i)return;i=!0,a=localStorage.getItem(e("agree"))?JSON.parse(o(localStorage.getItem(e("agree")))):[];let r=a.includes(t);$.ajax({url:Joe.BASE_API,type:"POST",dataType:"json",data:{routeType:"handle_agree",cid:t,type:r?"disagree":"agree"},success(o){if(1!==o.code)return;if($(".joe_detail__agree .text").html(o.data.agree),r){const e=a.findIndex(e=>e===t);a.splice(e,1),$(".joe_detail__agree .icon-1").removeClass("active"),$(".joe_detail__agree .icon-2").addClass("active"),$(".joe_detail__agree .icon").removeClass("active")}else a.push(t),$(".joe_detail__agree .icon-2").removeClass("active"),$(".joe_detail__agree .icon-1").addClass("active"),$(".joe_detail__agree .icon").addClass("active");const i=e("agree"),n=e(JSON.stringify(a));localStorage.setItem(i,n)},complete(){i=!1}})})}{let e=!1;$(".joe_detail__article-protected").on("submit",function(o){o.preventDefault();const a=$(this).attr("action")+"&time="+ +new Date,i=$(this).find('input[type="password"]').val();if(""===i.trim())return Qmsg.info("请输入访问密码！");e||(e=!0,$.ajax({url:a,type:"POST",data:{cid:t,protectCID:t,protectPassword:i},dataType:"text",success(o){let t=[],a="";t=$(o).contents(),Array.from(t).forEach(e=>{"container"===e.parentNode.className&&(a=e)}),/Joe/.test(o)?location.reload():(Qmsg.warning(a.textContent.trim()||""),e=!1,$(".joe_comment__respond-form .foot .submit button").html("发表评论"))}}))})}if($(".joe_detail__article-video").length>0){const e=$(".joe_detail__article-video .play iframe").attr("data-player");$(".joe_detail__article-video .episodes .item").on("click",function(){$(this).addClass("active").siblings().removeClass("active");const o=$(this).attr("data-src");let t=$(this).attr("alt");$(".joe_detail__article-video .play iframe").attr({src:e+o+"&autoplay=1&screenshot=1&theme="+encodeURIComponent(getComputedStyle(document.documentElement).getPropertyValue("--theme").trim())}),t&&$(".joe_detail__article-video .play .title").html(t)}),$(".joe_detail__article-video .episodes .item").first().click()}$(".joe_detail__operate-share").length&&($(".joe_detail__operate-share > svg").on("click",e=>{e.stopPropagation(),$(".joe_detail__operate-share").toggleClass("active")}),$(document).on("click",()=>$(".joe_detail__operate-share").removeClass("active")))}),window.addEventListener("load",function(){{const e=new URLSearchParams(location.search).get("scroll");if(e){let o=null;if(o=$("#"+e).length>0?$("#"+e):$("."+e),o&&o.length>0){const e=o.offset().top-$(".joe_header").height()-15;window.scrollTo({top:e,behavior:"smooth"})}}}});